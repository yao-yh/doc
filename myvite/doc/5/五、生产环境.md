# é‡æ–°å­¦ä¹ å‰ç«¯å·¥ç¨‹åŒ–ï¼šæ‰‹æ“ Vite(ä¸‰)  

> **æœ‰äº›äº‹ï¼Œä¸äº²è‡ªåŠ¨æ‰‹ï¼Œä½ æ°¸è¿œä¸ä¼šçŸ¥é“å®ƒæœ‰å¤šç®€å•â€”â€”æˆ–è€…å¤šéš¾ï¼**  
> ä»Šå¤©ï¼Œæˆ‘ä»¬ä¸åš Vite çš„æ¬è¿å·¥ï¼Œè€Œæ˜¯å°è¯•äº²æ‰‹é€ ä¸€ä¸ªè¿·ä½ ç‰ˆï¼Œå·©å›ºä¸€ä¸‹å‰ç«¯å·¥ç¨‹åŒ–çš„çŸ¥è¯†ã€‚  

## ğŸ¯ æœ¬æ¬¡ç›®æ ‡

- **å®ç° `myvite build` å‘½ä»¤**ï¼Œç”¨äºæ„å»º Vue + TypeScript é¡¹ç›®ã€‚
- **ä½¿ç”¨ Rollup è¿›è¡Œæ‰“åŒ…**ï¼Œç¡®ä¿æœ€ç»ˆç”Ÿæˆçš„äº§ç‰©å¯åœ¨æµè§ˆå™¨ä¸­æ­£å¸¸è¿è¡Œã€‚
- **æ‰“åŒ…åçš„æ–‡ä»¶å¯ç›´æ¥æ”¾å…¥ Web æœåŠ¡å™¨**ï¼Œå¹¶èƒ½æ­£ç¡®åŠ è½½å’Œæ‰§è¡Œã€‚

---

## âš™ï¸ **Rollup çš„åŸºç¡€é…ç½®**

Vite åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ï¼Œé»˜è®¤æ˜¯ä½¿ç”¨ **Rollup** è¿›è¡Œé¡¹ç›®æ‰“åŒ…çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¹Ÿå°†åŸºäº Rollup æ¥ç¼–å†™ä¸€ä¸ªç®€åŒ–ç‰ˆçš„æ„å»ºè„šæœ¬ã€‚

``` javascript
// build.js

// çœç•¥äº†ä¾èµ–çš„å¼•ç”¨

const BUILD_HTMLTITLE = 'App'

async function createBuild(root, config) {
  const { outDir, assetsDir='assets' } = config.build

  const template = path.join(config.root, 'index.html')
  if (!fs.existsSync(template)) {
    throw new Error('No index.html found in root directory')
  }

  const dir = path.join(root, outDir || 'dist')
  const main = '/src/main.ts'
  const input = path.join(root, main)

  const inputOptions = {
    input,
    plugins: [
      // åœ¨æ„å»ºå‰åˆ é™¤ dist ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶
      del({ targets: outDir }),
      // å¯ä»¥ä»£ç ä¸­ä½¿ç”¨ @ åˆ«å
      alias({
        '@': fileURLToPath(new URL('./src', import.meta.url))
      }),
      // è§£æ .vue æ–‡ä»¶ä¸º sfc
      vue(),
      // å¤„ç†css
      styles({
        mode: 'extract',
        minimize: true,
      }),
      // esbuildï¼Œè¿™é‡Œç”¨æ¥ç¼–è¯‘ TypeScript
      esbuild({ target: 'esnext', loader: 'ts' }), // ä½¿ç”¨ esbuild ç¼–è¯‘ TypeScript
      // rollup èƒ½å¤Ÿè¯†åˆ«å’Œå¤„ç† npm åŒ…
      resolve(),
      // å°†ä»£ç ä¸­çš„ process.env.NODE_ENV æ›¿æ¢ä¸º production
      replace({
        preventAssignment: true,
        'process.env.NODE_ENV': JSON.stringify('production'),
      }),
      // rollup èƒ½å¤Ÿè¯†åˆ« commonjs æ¨¡å—
      commonjs(),
      // å¤„ç†å›¾ç‰‡
      url({
        include: ['**/*.svg', '**/*.png', '**/*.jpg', '**/*.gif'],
        limit: 0,
        fileName: `./${assetsDir}/[name]-[hash][extname]`,
      }),
      // å¤„ç† html æ–‡ä»¶ã€‚è¿™é‡Œä¸ºäº† html æ–‡ä»¶ä¸­å¼•å…¥ç¼–è¯‘æ–°ç”Ÿæˆçš„ css å’Œ js æ–‡ä»¶ã€‚å¹¶åˆ é™¤å¯¹å¼€å‘ç¯å¢ƒçš„ css å’Œ js çš„å¼•å…¥
      html({
        title: BUILD_HTMLTITLE,
        template: async ({ files }) => {
          // files æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«äº† entrypoints ç”Ÿæˆçš„æ‰€æœ‰æ–‡ä»¶
          // æˆ‘ä»¬éœ€è¦æŠŠä»–ä»¬æŒ‰é¡ºåºå¼•å…¥åˆ° html æ¨¡æ¿ä¸­

          let code = fs.readFileSync(template).toString()
          code = code.replace(`<script type="module" src="${main}"></script>`, '')

          let fileTags = []
          if (files.css) {
            const cssTags = files.css.map((item) => {
              return '\t' + `<link rel="stylesheet" href="/${item.fileName}">`
            })
            fileTags = [...fileTags, ...cssTags]
          }
          if (files.js) {
            const jsTags = files.js.map((item) => {
              return (
                '\t' + `<script type="module" src="/${item.fileName}"></script>`
              )
            })
            fileTags = [...fileTags, ...jsTags]
          }
          if (fileTags.length) {
            code = code.replace('</head>', fileTags.join('\n') + '\n</head>')
          }
          return code
        },
      }),
      // å‹ç¼© js æ–‡ä»¶
      terser()
    ],
  }
  const outputOptions = {
    dir,
    format: 'es',
    entryFileNames: `${assetsDir}/index-[hash].js`,
    assetFileNames: `${assetsDir}/[name]-[hash].[ext]`,
    chunkFileNames: `${assetsDir}/[name]-[hash].js`,
  }
  const start = Date.now()
  const bundle = await rollup(inputOptions)
  await bundle.write(outputOptions)
  await bundle.close()
  const end = Date.now()
  console.log(`âœ“ built in ${Math.round(end - start)}ms`)
}

export { createBuild }
```

åœ¨ `index.js` ä¸­é…ç½® `build` å‘½ä»¤

``` javascript
// index.js

if (mode === 'build') {
  const { createBuild } = await import('./build.js')
  createBuild(root, config)
} else if (mode === 'dev' || mode === 'serve') {

```

æ‰“åŒ…æµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š

![Vite Logo](é»˜è®¤é…ç½®ç¼–è¯‘ç»“æœ.png)

ä»æˆªå›¾å¯ä»¥çœ‹å‡ºï¼ŒRollup å·²ç»æˆåŠŸæ‰§è¡Œäº†æ‰“åŒ…æ“ä½œï¼Œå¹¶è¾“å‡ºäº†å¯¹åº”çš„æ„å»ºäº§ç‰©ã€‚  

ä¸è¿‡ï¼Œç›®å‰è¿™åªæ˜¯æœ€åŸºç¡€çš„é»˜è®¤é…ç½®ï¼Œè¿˜æ²¡æœ‰åº”ç”¨é…ç½®æ–‡ä»¶ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦ç»§ç»­å®ç°è¿™ä¸ªé€»è¾‘

## ğŸ“Œ **ä½¿ç”¨ Vite çš„é…ç½®**

åœ¨ç»§ç»­ä¼˜åŒ– Rollup æ„å»ºä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆç ”ç©¶ä¸€ä¸‹ Vite é»˜è®¤çš„æ„å»ºé…ç½®ã€‚  
ä»¥ä¸‹æ˜¯ä¸€ä¸ª Vite å¤„ç† Vue3 + TypeScript é¡¹ç›®çš„åŸºç¡€é…ç½®ç¤ºä¾‹ï¼š

``` javascript
// vite.config.ts

import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'
import vueJsx from '@vitejs/plugin-vue-jsx'
import { fileURLToPath, URL } from 'node:url'

export default defineConfig((config) => {
  return {
    build: {
      rollupOptions: {
        input: {
          normal: 'index.html'
        },
        // é™æ€èµ„æºåˆ†ç±»æ‰“åŒ…
        output: {
          chunkFileNames: 'static/js/[name]-[hash].js',
          entryFileNames: 'static/js/[name]-[hash].js',
          assetFileNames: 'static/[ext]/[name]-[hash].[ext]'
        }
      }
    },
    plugins: [vue(), vueJsx(), terser()],
    resolve: {
      alias: {
        '@': fileURLToPath(new URL('./src', import.meta.url))
      }
    }
  }
})
```

åœ¨æ­£å¼å¼€å‘å‰ï¼Œæˆ‘ä»¬å…ˆé€šè¿‡å®˜æ–¹æ–‡æ¡£åˆ†æ Vite é…ç½®çš„ä½œç”¨ã€‚

![Vite Logo](viteé…ç½®åˆ†ç±».png))


å¯¹äºæœ¬æ¬¡æ„å»ºï¼Œæˆ‘ä»¬ä¸»è¦å…³æ³¨ **å…±äº«é€‰é¡¹** å’Œ **æ„å»ºé€‰é¡¹**

ç»“åˆ Vite ä¸ Rollup å®˜æ–¹æ–‡æ¡£ï¼Œæˆ‘ä»¬æ•´ç†äº†ä¸€äº›å…³é”®çš„åŸºç¡€é…ç½®ï¼š


### ğŸŒ **å…±äº«é€‰é¡¹ï¼ˆCommon Optionsï¼‰**
è¿™äº›é€‰é¡¹é€‚ç”¨äº **å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒ**ï¼Œä¸»è¦å½±å“é¡¹ç›®çš„ç»“æ„å’Œæ¨¡å—è§£ææ–¹å¼ã€‚

- **`root`**ï¼šæŒ‡å®šé¡¹ç›®çš„æ ¹ç›®å½•ï¼Œé€šå¸¸æ˜¯ `index.html` æ–‡ä»¶æ‰€åœ¨çš„ä½ç½®ã€‚
- **`plugins`**ï¼šå®šä¹‰ Vite æ’ä»¶åˆ—è¡¨ï¼Œå¯ç”¨äºæ‰©å±•åŠŸèƒ½ï¼ˆå¦‚ Vue è§£æã€TypeScript æ”¯æŒï¼‰ã€‚
- **`resolve.alias`**ï¼šè®¾ç½®è·¯å¾„åˆ«åï¼ˆä¾‹å¦‚ Vue é¡¹ç›®ä¸­å¸¸è§çš„ `@` ä»£è¡¨ `src` ç›®å½•ï¼‰ã€‚

---

### ğŸ“¦ **æ„å»ºé€‰é¡¹ï¼ˆBuild Optionsï¼‰**
è¿™äº›é€‰é¡¹ä¸»è¦å½±å“ **ç”Ÿäº§ç¯å¢ƒ** ä¸‹çš„æ‰“åŒ…æ–¹å¼ã€‚

- **`build.outDir`**ï¼šæŒ‡å®šæ„å»ºè¾“å‡ºç›®å½•ï¼Œé€šå¸¸é»˜è®¤ä¸º `dist`ã€‚
- **`build.assetsDir`**ï¼šè®¾ç½®é™æ€èµ„æºå­˜æ”¾ç›®å½•ï¼ˆç›¸å¯¹äº `build.outDir`ï¼‰ã€‚
- **`build.rollupOptions`**ï¼šè‡ªå®šä¹‰åº•å±‚çš„ Rollup é…ç½®ï¼ŒåŒ…æ‹¬ï¼š
  - **`input`**ï¼šæŒ‡å®š Rollup å…¥å£æ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯ `index.html`ï¼‰ã€‚
  - **`output.chunkFileNames`**ï¼šç”¨äºä»£ç åˆ†å‰²æ—¶ï¼ŒåŠ¨æ€ç”Ÿæˆçš„ chunk æ–‡ä»¶çš„å‘½åè§„åˆ™ã€‚
  - **`output.entryFileNames`**ï¼šæŒ‡å®šå…¥å£æ–‡ä»¶çš„è¾“å‡ºå‘½åè§„åˆ™ã€‚
  - **`output.assetFileNames`**ï¼šå®šä¹‰é™æ€èµ„æºï¼ˆCSSã€å›¾ç‰‡ç­‰ï¼‰çš„æ–‡ä»¶å‘½åæ–¹å¼ã€‚
  - **`plugins`**ï¼šç”¨äºè‡ªå®šä¹‰ Rollup æ’ä»¶åˆ—è¡¨ï¼Œä»¥æ‰©å±•æ„å»ºèƒ½åŠ›ã€‚

---

åœ¨ Vite é…ç½®ä¸­ï¼Œéƒ¨åˆ† **å…±äº«é€‰é¡¹ï¼ˆCommon Optionsï¼‰** ç›´æ¥å½±å“ **æ„å»ºé€‰é¡¹ï¼ˆBuild Optionsï¼‰**ã€‚å› æ­¤ï¼Œåœ¨æ„å»ºæ—¶ï¼Œæˆ‘ä»¬éœ€è¦å°†æŸäº›å…±äº«é€‰é¡¹æ˜ å°„åˆ° `build.rollupOptions` ä¸­

### ğŸ“Œ **å…³é”®é…ç½®æ˜ å°„**
1. **`root`** å½±å“ **`build.rollupOptions.input`**  
   - `root` ä½œä¸ºé¡¹ç›®æ ¹ç›®å½•ï¼Œä¼šå½±å“ Rollup æŸ¥æ‰¾å…¥å£æ–‡ä»¶çš„ **ç›¸å¯¹è·¯å¾„**ã€‚

2. **`plugins`** å½±å“ **`build.rollupOptions.plugins`**  
   - `plugins` ä¸»è¦ç”¨äº Vite å¼€å‘ç¯å¢ƒï¼Œä½†åœ¨æ„å»ºæ—¶ï¼Œä¹Ÿå¯èƒ½éœ€è¦ **æ›¿æ¢** æˆ– **æ‹†åˆ†** éƒ¨åˆ†æ’ä»¶ã€‚

3. **`resolve.alias`** å½±å“ **Rollup çš„ alias é…ç½®**  
   - Vite çš„ `resolve.alias` éœ€è¦æ˜ å°„åˆ° Rollup çš„ `alias` æ’ä»¶ï¼Œä»¥ç¡®ä¿æ„å»ºæ—¶è·¯å¾„è§£æä¸€è‡´ã€‚

### âœ¨ **ä¼˜åŒ–æ€è·¯**
ä¸ºäº†ç®€åŒ–é…ç½®è¿ç§»ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™ä¸€ä¸ª **è½¬æ¢å‡½æ•°**ï¼Œå°† **å…±äº«é€‰é¡¹** å¤åˆ¶åˆ° **æ„å»ºé€‰é¡¹** ä¸­ï¼Œå¹¶æä¾›åˆç†çš„é»˜è®¤å€¼ã€‚ä¾‹å¦‚ï¼š
- **è‡ªåŠ¨å¡«å…… `build.rollupOptions.input`**  
- **åˆå¹¶ `plugins`ï¼Œä»¥ç¡®ä¿ Rollup æ­£ç¡®è§£æ Vueã€TypeScript ç­‰**
- **è°ƒæ•´ `resolve.alias`ï¼Œä½¿ Rollup ä¹Ÿèƒ½ä½¿ç”¨è·¯å¾„åˆ«å**

è¿™æ ·ï¼Œæˆ‘ä»¬å°±èƒ½ç¡®ä¿ **å¼€å‘ç¯å¢ƒå’Œæ„å»ºç¯å¢ƒçš„é…ç½®å°½å¯èƒ½ä¿æŒä¸€è‡´**ï¼Œé¿å…é¢å¤–çš„æ‰‹åŠ¨é…ç½®è°ƒæ•´ã€‚


``` javascript
// config.js

const OPTIMIZER_PATH = '/node_modules/.myvite/deps'
const CLIENT_FILE = 'client.js'
const CLIENT_PATH = `/@myvite/${CLIENT_FILE}`

const defaultConfig = {
  root: '',
  server: {
    host: 'localhost',
    port: 5173,
  },
  build: {
    outDir: 'dist',
    assetsDir: 'assets',
    rollupOptions: {
      input: '',
      output: {
        format: 'es',
        chunkFileNames: 'assets/js/[name]-[hash].js',
        entryFileNames: 'assets/js/[name]-[hash].js',
        assetFileNames: 'assets/[ext]/[name]-[hash].[ext]',
      }
    }
  },
  plugins: [],
  resolve: {
    alias: void 0
  }
}

function getConfigPath(root) {
  for (const file of fs.readdirSync(root)) {
    if (file.includes('vite.config')) {
      return path.join(root, file)
    }
  }

  throw new Error('No myvite.config.js found in root directory')
}

function resolveDevConfig(config) {
  return config
}

function resolveProdConfig(config) {
  // è¿™é‡Œåªæ˜¯ç®€å•å¤„ç†å‡ ä¸ªå‚æ•°
  function findInputInRoot(root) {
    const rootPath = path.join(root, 'src')
  
    for (const file of fs.readdirSync(rootPath)) {
      if (file.startsWith('main')) {
        return path.join(rootPath, file)
      }
    }
  
    throw new Error('No entry file found in src directory')
  }
  
  // æ²¡æœ‰è®¾ç½®inputçš„ä¸€ä¸ªç®€å•å¤„ç†
  if (!config.build.input) {
    config.build.input = findInputInRoot(config.root)
  }
  // è¿™é‡Œåº”è¯¥è€ƒè™‘ä¸‹å¤šå…¥åº“çš„æƒ…å†µï¼ˆå‡½æ•°ã€å¯¹è±¡ã€æ•°ç»„ï¼‰ã€‚è¿™é‡Œåªæ˜¯ç®€å•å¤„ç†
  config.build.input = path.join(config.root, config.build.input)

  if (!config.build.rollupOptions.input) {
    config.build.rollupOptions.input = findInputInRoot(config.root)
  }

  // æ²¡æœ‰è®¾ç½®output dirçš„ä¸€ä¸ªç®€å•å¤„ç†
  if (!config.build.rollupOptions.output.dir) {
    config.build.rollupOptions.output.dir = path.join(config.root, config.build.outDir || 'dist')
  }

  return config
}

async function createConfig(root, env='dev') {
  defaultConfig.root = root

  const importConfig = (
    await import(pathToFileURL(getConfigPath(root)).href)
  ).default

  // å°†é»˜è®¤é…ç½®å’Œå¯¼å…¥é…ç½®åˆå¹¶
  const config = merge(defaultConfig, importConfig)
  return env === 'prod' ? resolveDevConfig(config) : resolveProdConfig(config)
}

export { createConfig, OPTIMIZER_PATH, CLIENT_PATH, CLIENT_FILE }
```


``` javascript
// devServer.js

// çœç•¥ä¾èµ–çš„å¼•ç”¨

const BUILD_HTMLTITLE = 'App'

function resolvePlugins(userPlugins) {
  const prePlugins = []
  const normalPlugins = []
  const postPlugins = []

  // è¿™é‡Œä¸»è¦ä½¿ç”¨æ’ä»¶çš„ä¸¤ä¸ªå±æ€§
  // enforce: 'pre' | 'post' | void
  // name: string
  // é€šè¿‡ enforce æ¥åŒºåˆ†æ’ä»¶çš„æ‰§è¡Œé¡ºåº
  // é€šè¿‡ name æ¥åŒºåˆ†æ’ä»¶çš„å”¯ä¸€æ€§ã€‚å¦‚æœå®¢æˆ·è®¾ç½®äº†å’Œé»˜è®¤æ’ä»¶é‡åçš„æ’ä»¶ï¼Œé‚£ä¹ˆé»˜è®¤æ’ä»¶ä¼šè¢«è¦†ç›–
  // è¿™é‡Œæ²¡æœ‰è€ƒè™‘æ’ä»¶è¦†ç›–ã€‚ã€‚
  for (const plugin of userPlugins) {
    if (plugin.enforce === 'pre') {
      prePlugins.push(plugin)
    } else if (plugin.enforce === 'post') {
      postPlugins.push(plugin)
    } else {
      normalPlugins.push(plugin)
    }
  }

  return [prePlugins, normalPlugins, postPlugins]
}

async function createBuild(root, config) {
  const { outDir, assetsDir='assets' } = config.build

  const template = path.join(config.root, 'index.html')
  if (!fs.existsSync(template)) {
    throw new Error('No index.html found in root directory')
  }

  const mainFile = path.basename(config.build.rollupOptions.input)

  const [prePlugins, normalPlugins, postPlugins] = resolvePlugins(config.plugins || [])

  const inputOptions = {
    input: config.build.rollupOptions.input,
    plugins: [
      // è¿™é‡Œå­˜çš„éƒ½æ˜¯ç»å¯¹ä¸ä¼šä¿®æ”¹çš„æ’ä»¶ã€‚ç†è®ºä¸Šéƒ½ä¸æ”¯æŒé…ç½®
      // è¿™é‡Œå†™çš„åªæ˜¯ç¤ºä¾‹
      // åœ¨æ„å»ºå‰åˆ é™¤ dist ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶
      del({ targets: outDir }),
      // æ³¨é‡Šä»¥ä¸‹ä¸¤ä¸ªï¼Œä½¿ç”¨ç”¨æˆ·é…ç½®çš„æ’ä»¶
      // // å¯ä»¥ä»£ç ä¸­ä½¿ç”¨ @ åˆ«å
      // alias(),
      // // è§£æ .vue æ–‡ä»¶ä¸º sfc
      // vue(),
      // å­˜å‚¨çš„å®¢æˆ·é…ç½®çš„å‰ç½®æ‰§è¡Œçš„æ’ä»¶
      ...prePlugins,
      // å­˜å‚¨çš„å®¢æˆ·é…ç½®çš„æ­£å¸¸é¡ºåºæ‰§è¡Œçš„æ’ä»¶
      ...normalPlugins,
      // å¤„ç†css
      styles({}), // çœç•¥æ’ä»¶çš„é…ç½®
      // esbuildï¼Œè¿™é‡Œç”¨æ¥ç¼–è¯‘ TypeScript
      esbuild({ target: 'esnext', loader: 'ts' }), // ä½¿ç”¨ esbuild ç¼–è¯‘ TypeScript
      // rollup èƒ½å¤Ÿè¯†åˆ«å’Œå¤„ç† npm åŒ…
      resolve(),
      // å°†ä»£ç ä¸­çš„ process.env.NODE_ENV æ›¿æ¢ä¸º production
      replace({}), // çœç•¥æ’ä»¶çš„é…ç½®
      // rollup èƒ½å¤Ÿè¯†åˆ« commonjs æ¨¡å—
      commonjs(),
      // å¤„ç†å›¾ç‰‡
      url({}), // çœç•¥æ’ä»¶çš„é…ç½®
      // å¤„ç† html æ–‡ä»¶ã€‚è¿™é‡Œä¸ºäº† html æ–‡ä»¶ä¸­å¼•å…¥ç¼–è¯‘æ–°ç”Ÿæˆçš„ css å’Œ js æ–‡ä»¶ã€‚å¹¶åˆ é™¤å¯¹å¼€å‘ç¯å¢ƒçš„ css å’Œ js çš„å¼•å…¥
      html({}), // çœç•¥æ’ä»¶çš„é…ç½®
      // å­˜å‚¨çš„å®¢æˆ·é…ç½®çš„åç½®æ‰§è¡Œçš„æ’ä»¶
      ...postPlugins,
      // å‹ç¼© js æ–‡ä»¶
      terser(),
      // å°† public ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶æ‹·è´åˆ° dist ç›®å½•
      copy({
        targets: [{ src: 'public/**/*', dest: outDir }]
      })
    ]
  }

  const start = Date.now()
  const bundle = await rollup(inputOptions)
  await bundle.write(config.build.rollupOptions.output)
  await bundle.close()
  const end = Date.now()
  console.log(`âœ“ built in ${Math.round(end - start)}ms`)
}

export { createBuild }
```

ç°åœ¨ï¼Œå°±æ˜¯æœ€åä¸€æ­¥

![Vite Logo](æµ‹è¯•ç»“æœ.png)

ğŸ‰ æ‰‹æ“ Vite ä¹‹æ—…å‘Šä¸€æ®µè½ï¼

ä»é›¶å¼€å§‹ï¼Œæˆ‘ä»¬ä¸€æ­¥æ­¥æ‹†è§£ Vite çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œå®ç°äº†å¼€å‘æœåŠ¡å™¨ã€HMRã€æ„å»ºæ‰“åŒ…ç­‰å…³é”®ç¯èŠ‚ã€‚é€šè¿‡è¿™æ¬¡å®è·µï¼Œç›¸ä¿¡ä½ å¯¹ Vite çš„å·¥ä½œåŸç†æœ‰äº†æ›´æ·±çš„ç†è§£ï¼Œä¹Ÿèƒ½æ›´å¥½åœ°è¿ç”¨åˆ°å®é™…é¡¹ç›®ä¸­ã€‚

è¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡æ­£å¼å†™ä¸“é¢˜æ–‡ç« ï¼Œå¦‚æœæœ‰å“ªé‡Œè®²è§£å¾—ä¸å¤Ÿæ¸…æ™°ï¼Œæˆ–è€…æœ‰å¯ä»¥æ”¹è¿›çš„åœ°æ–¹ï¼Œæ¬¢è¿ç›´æ¥æŒ‡å‡ºï¼Œæˆ‘ä¹Ÿä¼šæŒç»­ä¼˜åŒ–å†…å®¹ã€‚

å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼Œè®°å¾—ç‚¹ä¸ª å…³æ³¨ ğŸš€âœ¨
